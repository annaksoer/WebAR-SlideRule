<!DOCTYPE html><html><head></head><body><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">&lt;!DOCTYPE html&gt;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">&lt;head&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;title&gt;AR project template&lt;/title&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;!-- Додаємо необхідні бібліотеки --&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="js/three.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="js/tween.umd.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src='loaders/GLTFLoader.js'&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src='loaders/GLTF2Loader.js'&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src='loaders/MTLLoader.js'&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src='loaders/OBJLoader.js'&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;!-- Додаємо jsartookit --&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="jsartoolkit5/artoolkit.min.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="jsartoolkit5/artoolkit.api.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;!-- Додаємо threex.artoolkit --&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="threex/threex-artoolkitsource.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="threex/threex-artoolkitcontext.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="threex/threex-arbasecontrols.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script src="threex/threex-armarkercontrols.js"&gt;&lt;/script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">&lt;/head&gt;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">&lt;body style='margin : 0px; overflow: hidden; font-family: Monospace; user-select: none; pointer-events: none;'&gt;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;div id="access" style="top: 0; left: 0; right:0; bottom: 0; background: #000; position: absolute; user-select: all; pointer-events: all;"&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        &lt;div id="text-wrapper" style="top: 50%; left: 50%; position: absolute; color: #fff; transform: translate(-50%, -50%); text-align: center;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                text-transform: uppercase; font-family: Arial, Helvetica, sans-serif; font-weight: 400; line-height: 1.5em; font-size: large; white-space: nowrap;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                user-select: none; pointer-events: none;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            "&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            Press here</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            &lt;br&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            to enter the experience</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        &lt;/div&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;/div&gt;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;div id="loader" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: #fff; pointer-events: none; user-select: none;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        transition: all .2s linear; display: none;"&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        &lt;div style="left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); text-align: center; width: 130px; height: 165px;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            font-family: Arial, Helvetica, sans-serif; font-weight: 400; line-height: 1.5em; font-size: large;" class="spinner-wrapper"&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            &lt;img style="width: 130px; height: 130px; pointer-events: none; user-select: none;" src="data/spin.gif" alt="spin gif"&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            &lt;br&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            Loading...</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        &lt;/div&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;/div&gt;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;script&gt;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        const access = document.getElementById('access');</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        const loader = document.getElementById('loader');</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        function initiateExperience() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Оголошуємо глобальні змінні</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            var scene, camera, renderer, clock, deltaTime, totalTime;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            var patternIdOffset = 10000000000</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Змінні необхідні для роботи AR оточення</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            var arToolkitSource, arToolkitContext;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Головний контейнер, до якого увійдуть всі 3D об'єкти для програми</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            var markerRoot, mainContainer;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Окремий масив для зберігання всього аудіо та відео контенту, який буде</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // запущений натисканням на екран смартфона</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            var audioContent = [];</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            var contentPromises = [];</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            let contentInitialized = false;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            let barcodesSound = new Map();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            let patternsSound = new Map();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            let barcodesID = [];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            let patternsID = [];</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            let controller;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Ініціалізуємо сцену та запускаємо цикл анімації</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            initialize();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            animate();</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            function initialize() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Оголошуємо сцену, в яку додамо головний контейнер з усіма 3D об'єктами.</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                scene = new THREE.Scene();</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Додаємо світло на сцену, інакше базові матеріали будуть просто чорними.</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // т.к. їм нема чого відображати, зверніться до документації бібліотеки three.js, щоб</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // прочитати про докладну роботу класу Material</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                let ambientLight = new THREE.AmbientLight(0xffffff, 0.75);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                scene.add(ambientLight);</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Додаємо камеру, яка буде пізніше перепризначена на камеру смартфона</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                camera = new THREE.Camera();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                scene.add(camera);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const listener = new THREE.AudioListener();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                camera.add(listener);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const audioLoader = new THREE.AudioLoader();</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Оголошуємо стандартний рендерер і додаємо його до тега body html документа</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                renderer = new THREE.WebGLRenderer({</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    antialias: true,</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    alpha: true</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                });</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                renderer.setClearColor(new THREE.Color('lightgrey'), 0)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                renderer.setSize(640, 480);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                renderer.domElement.style.position = 'absolute'</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                renderer.domElement.style.top = '0px'</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                renderer.domElement.style.left = '0px'</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                document.body.appendChild(renderer.domElement);</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                clock = new THREE.Clock();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                deltaTime = 0;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                totalTime = 0;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                arToolkitSource = new THREEx.ArToolkitSource({</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    sourceType: 'webcam',</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                });</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Функція перерендерує AR сцену під поточний розмір canvas</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                function onResize() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    arToolkitSource.onResize()</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    arToolkitSource.copySizeTo(renderer.domElement)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    if (arToolkitContext.arController !== null) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        arToolkitSource.copySizeTo(arToolkitContext.arController.canvas)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Викликаємо функцію під час ініціалізації AR</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                arToolkitSource.init(function onReady() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    onResize()</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                });</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Викликаємо функцію на resize івент веб-сторінки</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                window.addEventListener('resize', function () {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    onResize()</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                });</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Ініціалізуємо AR контекст під камеру, патерни, баркод 3х3</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                arToolkitContext = new THREEx.ArToolkitContext({</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    cameraParametersUrl: 'data/camera_para.dat',</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    detectionMode: 'mono_and_matrix',</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    matrixCodeType: "3x3",</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    maxDetectionRate: 60,</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    canvasWidth: 640,</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    canvasHeight: 480</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                });</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Відновлюємо матрицю проекції камери після закінчення ініціалізації</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                arToolkitContext.init(function onCompleted() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    camera.projectionMatrix.copy(arToolkitContext.getProjectionMatrix());</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                });</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Створюємо головну групу для всіх 3D об'єктів</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                mainContainer = new THREE.Group();</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив назв файлів .patt. Масив заповнюється в порядку додавання маркерів</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // якщо замість .patt було додано баркод, на його місце в масив додається порожній рядок</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const patternNames = ["" ,"" ,""];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив баркодів, заповнюється одночасно з масивом патернів</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // якщо замість баркоду був доданий .patt, на його місце масив додається -1</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const patternBarcode = [1 ,2 ,3];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив типів контенту кожного маркера, заповнюється значеннями: зображення, модель, відео</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const modes = ["image" ,"image" ,"image"];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив файлів моделей, якщо немає моделі буде додано порожній рядок</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const modelFiles = ["" ,"" ,""];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив файлів зображень, якщо немає зображення буде додано також порожній рядок</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const imageFiles = ["Ліщук Анна АІ-233.jpg" ,"Вільям Отред.jpg" ,"фото_лінійки.jpg"];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив файлів відео, якщо немає відео буде ще один порожній рядок</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const videoFiles = ["" ,"" ,""];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив файлів аудіо, якщо немає аудіо буде так само порожній рядок</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const audioFiles = ["Ліщук Анна АІ-233.mp3" ,"Вільям Отред.mp3" ,"лінійка.mp3"];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Масив опцій повтору аудіо та відео контенту, по дефолту для всіх буде false</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const repeatOptions = ["false" ,"false" ,"false"];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">  </span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Створюємо масив для всіх маркерів</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const markerRoots = [];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                for (let i = 0; i &lt; 3; i++) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    markerRoots[i] = new THREE.Group();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">  </span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Проходимо по кожному маркеру з масиву і додаємо його в головний контейнер</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                for (let i = 0; i &lt; 3; i++) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    mainContainer.add(markerRoots[i]);</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    // Якщо поточний маркер – це баркод, створюємо AR контролер під баркод</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    // якщо поточний маркер це патерн, аналогічно створюємо AR контролер під патерн</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    if (patternBarcode[i] === -1) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        let markerControls1 = new THREEx.ArMarkerControls(arToolkitContext, markerRoots[i], {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            type: 'pattern', patternUrl: patternNames[i], size: 1 + (i + 1) / patternIdOffset</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        })</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        patternsID.push(patternNames[i]);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    } else {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        let markerControls1 = new THREEx.ArMarkerControls(arToolkitContext, markerRoots[i], {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            type: "barcode", barcodeValue: patternBarcode[i],</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        })</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        barcodesID.push(patternBarcode[i]);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    // Використовуємо switch для роботи з кожним окремим випадком контенту</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    switch (modes[i]) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        // Якщо контент під маркер це модель</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        case 'model':</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            function onProgress(xhr) { console.log((xhr.loaded / xhr.total * 100) + '% loaded'); }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            function onError(xhr) { console.log('An error happened'); }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            contentPromises.push(new Promise((resolve) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                const test = new THREE.GLTF2Loader().load(`${modelFiles[i]}`, (response) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    const scene = response.scene;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    const object = scene.children[0];</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // Іноді модель не можна побачити з кількох причин, найчастіше варто збільшити чи зменшити у 100 разів.</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // Читайте: https://threejs.org/docs/index.html#manual/en/introduction/Loading-3D-models</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // Тут ми зменшуємо її, щоб точно побачити її на сцені. Ви можете видалити цю шкалу, якщо потрібно</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    object.scale.set(0.01, 0.01, 0.01);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // Ви можете самостійно змінити поворот або позицію моделі</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // object.position.set(0, Math.PI / 2, Math.PI / 4);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // object.rotation.set(0, Math.PI / 2, Math.PI / 4);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // Додавання нашої моделі до контейнера групи маркерів</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    markerRoots[i].add(object);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    resolve(modelFiles[i])</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                }, onProgress, onError)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            }).then((file) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                console.log(`File ${file} loaded`)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            }))</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            break;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        // Якщо контент під маркер це зображення</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        case 'image':</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            if (imageFiles[i]) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                contentPromises.push(new Promise((resolve) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    // Завантажуємо зображення</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    let loader = new THREE.TextureLoader();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    loader.load(`${imageFiles[i]}`, (texture) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        let geometry1, ratio = texture.image.naturalWidth / texture.image.naturalHeight;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        if (texture.image.naturalHeight &lt; texture.image.naturalWidth) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                            geometry1 = new THREE.PlaneBufferGeometry(ratio, 1);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        } else {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                            geometry1 = new THREE.PlaneBufferGeometry(1, 1 / ratio);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        let material1 = new THREE.MeshBasicMaterial({ map: texture, side: THREE.DoubleSide });</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        mesh1 = new THREE.Mesh(geometry1, material1);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        // Повертаємо площину</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        mesh1.rotation.x = -Math.PI / 2;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        // Додаємо площину у контейнер</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        markerRoots[i].add(mesh1);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        resolve(imageFiles[i])</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    });</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                }).then(image =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    console.log(`File ${image} loaded`)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                }))</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            break;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        // Якщо контент під маркер - це відео</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        case 'video':</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Оголошуємо площину під відео</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            let geometry2 = new THREE.PlaneBufferGeometry(1.6 , 0.9);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Оголошуємо та завантажуємо відео</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            let video = document.createElement('video');</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            video.src = `${videoFiles[i]}`;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            video.playsInline = true;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Встановлюємо відео на автоповтор залежно від значення у масиві</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            if (repeatOptions[i]) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                video.addEventListener('ended', () =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    video.play();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                })</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Додаємо відео до масиву аудіо контенту</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            if (patternBarcode[i] === -1) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                patternsSound.set(i, video);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            } else {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                barcodesSound.set(patternBarcode[i], video);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Перенаправляємо текстуру з відео на матеріал для площини.</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            let texture2 = new THREE.VideoTexture(video);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            texture2.minFilter = THREE.LinearFilter;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            texture2.magFilter = THREE.LinearFilter;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            texture2.format = THREE.RGBFormat;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            let material2 = new THREE.MeshBasicMaterial({ map: texture2 });</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            mesh2 = new THREE.Mesh(geometry2, material2);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Повертаємо площину</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            mesh2.rotation.x = -Math.PI / 2;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Додаємо площину у контейнер</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            markerRoots[i].add(mesh2);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            break;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        case 'controller':</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            controller = new THREE.Mesh(</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                new THREE.CubeGeometry(10, 0.15, 0.15),</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                new THREE.MeshBasicMaterial({ color: 'green' })</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            );</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            controller.rotation.y = Math.PI / 2;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            controller.position.y = 0.125;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            controller.position.z = -4.5;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            markerRoots[i].add(controller);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            break;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        default:</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Якщо жодного контенту не додано, додаємо білу площину.</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            mesh11 = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1),</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                new THREE.MeshBasicMaterial({ color: '#fff' }));</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Повертаємо площину</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            mesh11.rotation.x = -Math.PI / 2;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            // Додаємо площину у контейнер</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            markerRoots[i].add(mesh11);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            break;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    // Якщо є аудіо файли, налаштовуємо їх і додаємо в масив аудіо контенту.</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    if (audioFiles[i]) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        contentPromises.push(new Promise((resolve, reject) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            audioLoader.load(`${audioFiles[i]}`, function (buffer) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                // Створюємо аудіо джерело</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                let sound = new THREE.Audio(listener);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                sound.name = `${audioFiles[i]}`;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                sound.setBuffer(buffer);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                // Встановлюємо відео на автоповтор залежно від значення у масиві</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                if (repeatOptions[i]) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    sound.setLoop(true);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                if (patternBarcode[i] === -1) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    patternsSound.set(i, sound);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                } else {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    barcodesSound.set(patternBarcode[i], sound);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                resolve(sound)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            });</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        }).then((sound) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            sound.play()</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            sound.stop()</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            console.log(`File ${sound.name} loaded`)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        }))</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Ховаємо лоадер після завантаження компонентів</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                Promise.all(contentPromises)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    .then(() =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        console.log('Most of the content loaded')</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        contentInitialized = true;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        loader.style.opacity = '0';</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    });</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Додаємо головний контейнер на сцену</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                scene.add(mainContainer);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            function checkController() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                if (controller) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    mainContainer.traverse((object) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        if (object.isMesh &amp;&amp; object !== controller) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            if (detectCollisionCubes(object, controller)) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                object.material.color.set('red')</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            } else {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                object.material.color.set('white')</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    });</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Функція пошуку перетинів між двома об'єктами сцени</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            function detectCollisionCubes(object1, object2) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                object1.geometry.computeBoundingBox();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                object2.geometry.computeBoundingBox();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                object1.updateMatrixWorld();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                object2.updateMatrixWorld();</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const box1 = object1.geometry.boundingBox.clone();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                box1.applyMatrix4(object1.matrixWorld);</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                const box2 = object2.geometry.boundingBox.clone();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                box2.applyMatrix4(object2.matrixWorld);</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                return box1.intersectsBox(box2);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            };</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Оновлюємо AR контент на кожен кадр</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            function update() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                if (arToolkitSource.ready !== false) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    arToolkitContext.update(arToolkitSource.domElement);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    if (contentInitialized) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        if (barcodesID.length) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            barcodesID.forEach((elem, index) =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                if (arToolkitContext.arController.barcodeMarkers[elem].inCurrent) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    let sound = barcodesSound.get(elem);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    if (sound &amp;&amp; !sound.isPlaying) sound.play();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                } else {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    let sound = barcodesSound.get(elem);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    if (sound &amp;&amp; sound.nodeName === 'VIDEO') {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        if (!sound.paused) sound.pause()</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    if (sound &amp;&amp; sound.isPlaying) sound.stop();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            })</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        if (patternsID.length) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            for (let index = 0; index &lt; patternsID.length; index++) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                if (arToolkitContext.arController.patternMarkers[index].inCurrent) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    let patternID = (arToolkitContext.arController.patternMarkers[index].markerWidth - 1) * patternIdOffset - 1;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    patternID = Math.round(patternID)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    let sound = patternsSound.get(patternID);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    if (sound &amp;&amp; !sound.isPlaying) sound.play();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                } else {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    let patternID = (arToolkitContext.arController.patternMarkers[index].markerWidth - 1) * patternIdOffset - 1;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    patternID = Math.round(patternID)</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    let sound = patternsSound.get(patternID);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    if (sound &amp;&amp; sound.nodeName === 'VIDEO') {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                        if (!sound.paused) sound.pause()</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                    if (sound &amp;&amp; sound.isPlaying) sound.stop();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                                }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                            }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                        }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                    }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Рендерім сцену на кожен кадр</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            function render() {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                renderer.render(scene, camera);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            // Запускаємо цикл анімації</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            function animate(time) {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                // Прив'язуємо цикл анімації до рендеру браузера</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                requestAnimationFrame(animate);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                deltaTime = clock.getDelta();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                totalTime += deltaTime;</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                update();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                checkController();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">                render();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            }</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        }</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        // Прибираємо блок після натискання на екран для дозволу аудіо програвання на iOS</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        access.addEventListener('click', () =&gt; {</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            initiateExperience();</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            document.body.removeChild(access);</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">            loader.style.display = 'block';</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">        });</span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">    &lt;/script&gt;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">&lt;/body&gt;</span></p><br style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;"><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 18px; white-space: pre;">&lt;/html&gt;</span></p></body></html>